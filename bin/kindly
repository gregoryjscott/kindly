#!/usr/bin/env ruby

$:.unshift File.join(File.dirname(__FILE__), *%w{ .. lib })

require 'kindly'
require 'mercenary'

Mercenary.program(:kindly) do |p|
  p.version Kindly::VERSION
  p.description 'Kindly run migrations of any kind.'
  p.syntax 'kindly <handler> [options]'

  p.option 'source', '--source DIR', 'Host directory of the kindly directory structure.'
  p.action do |args, options|
    if args.empty?
      puts p
    elsif options['source']
      Kindly.run(args.first.to_sym, options['source'])
    else
      Kindly.run(args.first.to_sym)
    end
  end
end
